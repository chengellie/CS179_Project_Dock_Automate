{% extends "base.html" %}
{% block title %} Table {% endblock %}
{% block content %}
<style>
    table,
    th,
    td {
        border: 5px solid black;
        padding: 1px;
    }

    table {
        border-spacing: 3px;
    }
</style>

<div class="w3-row-padding">
    <div class="w3-half w3-container">
        <h5> </h5>
    </div>
    <div class="w3-half w3-container">
        <table style="width:100%">
            {%for i in range(row)%}
            <tr>
                {% for j in range(col)%}
                <td id="ship_{{i}}_{{j}}" style="background-color:{{color[0]}};color:white;">{{item[i][j]}}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </div>
</div>



<script>

    // https://stackoverflow.com/questions/3583724/how-do-i-add-a-delay-in-a-javascript-loop
    const timer = ms => new Promise(res => setTimeout(res, ms))

    async function swap() { // We need to wrap the loop into an async function for this to work
        var at = {{ at|tojson }};
        var go = {{ go|tojson }};
        for (var i = 0; i < at.length; i++) {
            console.log(i);
            var cell_start = $("#" + at[i]).text();
            var cell_end = $("#" + go[i]).text();
            $("#" + go[i]).text(cell_start);
            $("#" + go[i]).css('background-color', 'red');
            $("#" + at[i]).text(cell_end);
            $("#" + at[i]).css('background-color', 'rgb(44, 174, 214)');

            await timer(1000); // then the created Promise can be awaited
        }
    }

    $({{ at[0]}}).click(function () { 
        swap();
    });  
    
    


</script>
{% endblock %}